-- DIM_APPAREILS
CREATE TABLE DWH_DIM_APPAREILS (
    SK_APPAREIL_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    MARQUE VARCHAR2(100) NOT NULL,
    MODELE VARCHAR2(100) NOT NULL,
    CAPACITE NUMBER NOT NULL,
    ANNEE_FABRICATION NUMBER NOT NULL,
    STATUT VARCHAR2(50) NOT NULL,
    DATE_DEBUT_VALIDITE DATE DEFAULT SYSDATE NOT NULL, -- Pour SCD Type 2
    DATE_FIN_VALIDITE DATE, -- NULL si la version est active
    IS_CURRENT INT DEFAULT 1, -- 1: Actif, 0: Historique
    DATE_LOAD DATE DEFAULT SYSDATE NOT NULL
);

-- DIM_VOLS
CREATE TABLE DWH_DIM_VOLS (
    SK_VOL_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DATE_VOL DATE NOT NULL,
    VILLE_DEPART VARCHAR2(100) NOT NULL,
    VILLE_ARRIVEE VARCHAR2(100) NOT NULL,
    DISTANCE_VOL NUMBER NOT NULL,
    DUREE_VOL NUMBER NOT NULL,
    STATUT VARCHAR2(50) NOT NULL,
    DATE_DEBUT_VALIDITE DATE DEFAULT SYSDATE NOT NULL,
    DATE_FIN_VALIDITE DATE,
    IS_CURRENT INT DEFAULT 1,
    DATE_LOAD DATE DEFAULT SYSDATE NOT NULL
);

-- DIM_PARTICIPANTS
CREATE TABLE DWH_DIM_PARTICIPANTS (
    SK_PARTICIPANT_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOM VARCHAR2(100) NOT NULL,
    PRENOM VARCHAR2(100) NOT NULL,
    MILES_ACCUMULES NUMBER,
    STATUT_FIDELITE VARCHAR2(50) NOT NULL,
    AGE NUMBER NOT NULL,
    GENRE VARCHAR2(10) NOT NULL,
    EMAIL VARCHAR2(100) NOT NULL,
    TELEPHONE VARCHAR2(20),
    ADRESSE VARCHAR2(200) NOT NULL,
    VILLE VARCHAR2(200) NOT NULL,
    PAYS VARCHAR2(200) NOT NULL,
    DATE_DEBUT_VALIDITE DATE DEFAULT SYSDATE NOT NULL,
    DATE_FIN_VALIDITE DATE,
    IS_CURRENT INT DEFAULT 1,
    DATE_LOAD DATE DEFAULT SYSDATE NOT NULL
);

-- DIM_CANALDISTRIBUTION
CREATE TABLE DWH_DIM_CANALDISTRIBUTION (
    SK_CANAL_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOM_CANAL VARCHAR2(50) NOT NULL,
    TYPE_CANAL VARCHAR2(20) NOT NULL,
    DATE_DEBUT_VALIDITE DATE DEFAULT SYSDATE NOT NULL,
    DATE_FIN_VALIDITE DATE,
    IS_CURRENT INT DEFAULT 1,
    DATE_LOAD DATE DEFAULT SYSDATE NOT NULL
);

-- DIM_PROMOTION
CREATE TABLE DWH_DIM_PROMOTION (
    SK_PROMOTION_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOM_PROMOTION VARCHAR2(30) NOT NULL,
    DESCRIPTION VARCHAR2(100) NOT NULL,
    DATE_DEBUT_VALIDITE DATE DEFAULT SYSDATE NOT NULL,
    DATE_FIN_VALIDITE DATE,
    IS_CURRENT INT DEFAULT 1,
    DATE_LOAD DATE DEFAULT SYSDATE NOT NULL
);

-- DIM_BILLET
CREATE TABLE DWH_DIM_BILLET (
    SK_BILLET_ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TARIF_BASE NUMBER(10,2) NOT NULL,
    PRIX_ACHAT NUMBER(10,2) NOT NULL,
    DATE_ACHAT DATE NOT NULL,
    CLASSE VARCHAR2(20) NOT NULL,
    STATUT VARCHAR2(10) NOT NULL,
    DATE_DEBUT_VALIDITE DATE DEFAULT SYSDATE NOT NULL,
    DATE_FIN_VALIDITE DATE,
    IS_CURRENT INT DEFAULT 1,
    DATE_LOAD DATE DEFAULT SYSDATE NOT NULL
);
